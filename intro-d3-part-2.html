<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Intro to D3</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target=".scrollspy">
	<div class="container">
		<div class="row">
			<h1 class="text-center">Introduction to D3 (Part Two) <small>Ver. 3</small></h1>
		</div>
		<div class="col-md-2 side-menu scrollspy">
			<ul id="nav" class="nav hidden-xs hidden-sm" data-spy="affix">
				<li><a href="#bar-chart">Bar chart</a></li>
        <li><a href="#tilt-axis-text">Tilting axis text</a></li>
        <li><a href="#adding-colors-bar">Adding colors</a></li>
        <li><a href="#stack-layout">Stacked layout</a></li>
        <li><a href="#splitting-rect">Splitting a rectangle</a></li>
        <li><a href="#dimensions-split">Adding dimensions to split rectangles</a></li>
        <li><a href="#d3-nest">Introducing D3.nest</a></li>
        <li><a href="#nest-stack">Nest & stack</a></li>
        <li><a href="#stacked-bars">Stacked bars</a></li>
        <li><a href="#color-legend">Adding color legend</a></li>
			</ul>
		</div>
		<div class="col-md-10 col-xs-12 main-container">
			<br />
			<div id="bar-chart">
				<h4>Bar chart</h4>
				<div class="row panel">
          <div id="example-100"></div>
					<p>index.html</p>
					<code>
            &lt;style&gt; <br>
            &nbsp;path { <br>
            &nbsp;	fill: none; <br>
            &nbsp;	stroke: black; <br>
            &nbsp;	stroke-width: 2px; <br>
            &nbsp;} <br>
            <br>
            &lt;/style&gt; <br>
            <br>
            &lt;script&gt; <br>
            <br>
            &nbsp;// config vars <br>
            &nbsp;var outerWidth = 500; <br>
            &nbsp;var outerHeight = 250; <br>
            &nbsp;var margin = { left: 90, top: 30, right: 30, bottom: 30 }; <br>
            &nbsp;var barPadding = 0.2; <br>
            <br>
            &nbsp;// set x, y data <br>
            &nbsp;var xColumn = "country"; <br>
            &nbsp;var yColumn = "population"; <br>
            <br>
            &nbsp;// Label vars <br>
            &nbsp;var xAxisLabelText = "Top 5 countries"; <br>
            &nbsp;var xAxisLabelOffset = 50; <br>
            <br>
            &nbsp;var yAxisLabelText = "Population"; <br>
            &nbsp;var yAxisLabelOffset = 60; <br>
            <br>
            &nbsp;// set inner margin <br>
            &nbsp;var innerWidth  = outerWidth  - margin.left - margin.right; <br>
            &nbsp;var innerHeight = outerHeight - margin.top  - margin.bottom; <br>
            <br>
            &nbsp;// create svg <br>
            &nbsp;var svg = d3.select("body").append("svg") <br>
            &nbsp;  .attr("width",  outerWidth) <br>
            &nbsp;  .attr("height", outerHeight + xAxisLabelOffset); <br>
            &nbsp;var g = svg.append("g") <br>
            &nbsp;  .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); <br>
            <br>
            &nbsp;// setup axis <br>
            &nbsp;var xAxisG = g.append('g') <br>
            &nbsp;  .attr('class', 'x axis') <br>
            &nbsp;  .attr('transform', 'translate(0,' + innerHeight + ')') <br>
            &nbsp;var xAxisLabel = xAxisG.append("text") <br>
            &nbsp;  .style("text-anchor", "middle") <br>
            &nbsp;  .attr("transform", "translate(" + (innerWidth / 2) + "," + xAxisLabelOffset + ")") <br>
            &nbsp;  .attr("class", "label") <br>
            &nbsp;  .text(xAxisLabelText); <br>
            &nbsp;var yAxisG = g.append('g') <br>
            &nbsp;  .attr('class', 'y axis') <br>
            &nbsp;var yAxisLabel = yAxisG.append("text") <br>
            &nbsp;  .style("text-anchor", "middle") <br>
            &nbsp;  .attr("transform", "translate(-" + yAxisLabelOffset + "," + (innerHeight / 2) + ") rotate(-90)") <br>
            &nbsp;  .attr("class", "label") <br>
            &nbsp;  .text(yAxisLabelText); <br>
            <br>
            &nbsp;// set x, y scale range <br>
            &nbsp;var xScale = d3.scale.ordinal().rangeBands([0, innerWidth], barPadding); <br>
            &nbsp;var yScale = d3.scale.linear().range([innerHeight, 0]); <br>
            <br>
            &nbsp;// Use a modified SI formatter that uses "B" for Billion. <br>
            &nbsp;var siFormat = d3.format("s"); <br>
            &nbsp;var customTickFormat = function (d){ <br>
            &nbsp;  return siFormat(d).replace("G", "B"); <br>
            &nbsp;}; <br>
            <br>
            &nbsp;// Instantiate axes <br>
            &nbsp;var xAxis = d3.svg.axis().scale(xScale).orient("bottom") <br>
            &nbsp;  .outerTickSize(0); <br>
            &nbsp;var yAxis = d3.svg.axis().scale(yScale).orient("left") <br>
            &nbsp;  .ticks(5) <br>
            &nbsp;  .tickFormat(customTickFormat) <br>
            &nbsp;  .outerTickSize(0); <br>
            <br>
            &nbsp;function render(data){ <br>
            &nbsp;  xScale.domain(data.map( function (d){ return d[xColumn]; })); <br>
            &nbsp;  yScale.domain([0, d3.max(data, function (d){ return d[yColumn]; })]); <br>
            <br>
            &nbsp;  // render axes <br>
            &nbsp;  xAxisG.call(xAxis) <br>
            &nbsp;  yAxisG.call(yAxis);   <br>
            <br>
            &nbsp;  var bars = g.selectAll("rect").data(data); <br>
            <br>
            &nbsp;  // enter phase <br>
            &nbsp;  bars.enter().append("rect") <br>
            &nbsp;    .attr("width", xScale.rangeBand()); <br>
            <br>
            &nbsp;  // update phase <br>
            &nbsp;  bars <br>
            &nbsp;    .attr("x", function (d){ return xScale(d[xColumn]); }) <br>
            &nbsp;    .attr("y", function (d){ return yScale(d[yColumn]); }) <br>
            &nbsp;    .attr("height", function (d){ return innerHeight - yScale(d[yColumn]); }); <br>
            <br>
            &nbsp;  // exit phase
            &nbsp;  bars.exit().remove(); <br>
            &nbsp;} <br>
            <br>
            &nbsp;function type(d){ <br>
            &nbsp;  d.population = +d.population; <br>
            &nbsp;  return d; <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv("populationByCountry2015.csv", type, render); <br>
            <br>
            &lt;/script&gt;
					</code>
				</div>
      </div>
      <br>
      <div id="tilt-axis-text">
				<h4>Tilting axis text</h4>
				<div class="row panel">
          <div id="example-101"></div>
					<p>index.html</p>
					<code>
            &lt;style&gt; <br>
            &nbsp;path { <br>
            &nbsp;	fill: none; <br>
            &nbsp;	stroke: black; <br>
            &nbsp;	stroke-width: 2px; <br>
            &nbsp;} <br>
            <br>
            &lt;/style&gt; <br>
            <br>
            &lt;script&gt; <br>
            <br>
            &nbsp;// config vars <br>
            &nbsp;var outerWidth = 500; <br>
            &nbsp;var outerHeight = 250; <br>
            &nbsp;var margin = { left: 90, top: 30, right: 30, bottom: 30 }; <br>
            &nbsp;var barPadding = 0.2; <br>
            <br>
            &nbsp;// set x, y data <br>
            &nbsp;var xColumn = "religion"; <br>
            &nbsp;var yColumn = "population"; <br>
            <br>
            &nbsp;// Label vars <br>
            &nbsp;var xAxisLabelText = "Religions"; <br>
            &nbsp;var xAxisLabelOffset = 50; <br>
            <br>
            &nbsp;var yAxisLabelText = "Population"; <br>
            &nbsp;var yAxisLabelOffset = 60; <br>
            <br>
            &nbsp;// set inner margin <br>
            &nbsp;var innerWidth  = outerWidth  - margin.left - margin.right; <br>
            &nbsp;var innerHeight = outerHeight - margin.top  - margin.bottom; <br>
            <br>
            &nbsp;// create svg <br>
            &nbsp;var svg = d3.select("body").append("svg") <br>
            &nbsp;  .attr("width",  outerWidth) <br>
            &nbsp;  .attr("height", outerHeight + xAxisLabelOffset); <br>
            &nbsp;var g = svg.append("g") <br>
            &nbsp;  .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); <br>
            <br>
            &nbsp;// setup axis <br>
            &nbsp;var xAxisG = g.append('g') <br>
            &nbsp;  .attr('class', 'x axis') <br>
            &nbsp;  .attr('transform', 'translate(0,' + innerHeight + ')') <br>
            &nbsp;var xAxisLabel = xAxisG.append("text") <br>
            &nbsp;  .style("text-anchor", "middle")   br
            &nbsp;  .attr("transform", "translate(" + (innerWidth / 2) + "," + xAxisLabelOffset + ")") <br>
            &nbsp;  .attr("class", "label") <br>
            &nbsp;  .text(xAxisLabelText); <br>
            &nbsp;var yAxisG = g.append('g') <br>
            &nbsp;  .attr('class', 'y axis') <br>
            &nbsp;var yAxisLabel = yAxisG.append("text") <br>
            &nbsp;  .style("text-anchor", "middle") <br>
            &nbsp;  .attr("transform", "translate(-" + yAxisLabelOffset + "," + (innerHeight / 2) + ") rotate(-90)") <br>
            &nbsp;  .attr("class", "label") <br>
            &nbsp;  .text(yAxisLabelText); <br>
            <br>
            &nbsp;// set x, y scale range <br>
            &nbsp;var xScale = d3.scale.ordinal().rangeBands([0, innerWidth], barPadding); <br>
            &nbsp;var yScale = d3.scale.linear().range([innerHeight, 0]); <br>
            <br>
            &nbsp;// Use a modified SI formatter that uses "B" for Billion. <br>
            &nbsp;var siFormat = d3.format("s"); <br>
            &nbsp;var customTickFormat = function (d){ <br>
            &nbsp;  return siFormat(d).replace("G", "B"); <br>
            &nbsp;}; <br>
            <br>
            &nbsp;// Instantiate axes <br>
            &nbsp;var xAxis = d3.svg.axis().scale(xScale).orient("bottom") <br>
            &nbsp;  .outerTickSize(0); <br>
            &nbsp;var yAxis = d3.svg.axis().scale(yScale).orient("left") <br>
            &nbsp;  .ticks(5) <br>
            &nbsp;  .tickFormat(customTickFormat) <br>
            &nbsp;  .outerTickSize(0); <br>
            <br>
            &nbsp;function render(data){ <br>
            &nbsp;  xScale.domain(data.map( function (d){ return d[xColumn]; })); <br>
            &nbsp;  yScale.domain([0, d3.max(data, function (d){ return d[yColumn]; })]); <br>
            <br>
            &nbsp;  // render axes <br>
            &nbsp;  xAxisG <br>
            &nbsp;    .call(xAxis); <br>
            &nbsp;    .selectAll("text") <br>
            &nbsp;    .attr("dx", "-0.8em") <br>
            &nbsp;    .attr("dy", "1em") <br>
            &nbsp;    .attr("transform", "rotate(-20)"); <br>
            <br>
            &nbsp;  yAxisG.call(yAxis);   <br>
            <br>
            &nbsp;  var bars = g.selectAll("rect").data(data); <br>
            <br>
            &nbsp;  // enter phase <br>
            &nbsp;  bars.enter().append("rect") <br>
            &nbsp;    .attr("width", xScale.rangeBand()); <br>
            <br>
            &nbsp;  // update phase <br>
            &nbsp;  bars <br>
            &nbsp;    .attr("x", function (d){ return xScale(d[xColumn]); }) <br>
            &nbsp;    .attr("y", function (d){ return yScale(d[yColumn]); }) <br>
            &nbsp;    .attr("height", function (d){ return innerHeight - yScale(d[yColumn]); }); <br>
            <br>
            &nbsp;  // exit phase
            &nbsp;  bars.exit().remove(); <br>
            &nbsp;} <br>
            <br>
            &nbsp;function type(d){ <br>
            &nbsp;  d.population = +d.population; <br>
            &nbsp;  return d; <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv("religionWorldTotals.csv", type, render); <br>
            <br>
            &lt;/script&gt;
					</code>
				</div>
      </div>
      <br>
      <div id="adding-colors-bar">
				<h4>Adding colors</h4>
				<div class="row panel">
          <div id="example-102"></div>
					<p>index.html</p>
					<code>
            &lt;style&gt; <br>
            &nbsp;path { <br>
            &nbsp;	fill: none; <br>
            &nbsp;	stroke: black; <br>
            &nbsp;	stroke-width: 2px; <br>
            &nbsp;} <br>
            <br>
            &lt;/style&gt; <br>
            <br>
            &lt;script&gt; <br>
            <br>
            &nbsp;// config vars <br>
            &nbsp;var outerWidth = 500; <br>
            &nbsp;var outerHeight = 250; <br>
            &nbsp;var margin = { left: 90, top: 30, right: 30, bottom: 30 }; <br>
            &nbsp;var barPadding = 0.2; <br>
            <br>
            &nbsp;// set x, y data <br>
            &nbsp;var xColumn = "religion"; <br>
            &nbsp;var yColumn = "population"; <br>
            &nbsp;var colorColumn = "religion"; <br>
            <br>
            &nbsp;// Label vars <br>
            &nbsp;var xAxisLabelText = "Religions"; <br>
            &nbsp;var xAxisLabelOffset = 50; <br>
            <br>
            &nbsp;var yAxisLabelText = "Population"; <br>
            &nbsp;var yAxisLabelOffset = 60; <br>
            <br>
            &nbsp;// set inner margin <br>
            &nbsp;var innerWidth  = outerWidth  - margin.left - margin.right; <br>
            &nbsp;var innerHeight = outerHeight - margin.top  - margin.bottom; <br>
            <br>
            &nbsp;// create svg <br>
            &nbsp;var svg = d3.select("body").append("svg") <br>
            &nbsp;  .attr("width",  outerWidth) <br>
            &nbsp;  .attr("height", outerHeight + xAxisLabelOffset); <br>
            &nbsp;var g = svg.append("g") <br>
            &nbsp;  .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); <br>
            <br>
            &nbsp;// setup axis <br>
            &nbsp;var xAxisG = g.append('g') <br>
            &nbsp;  .attr('class', 'x axis') <br>
            &nbsp;  .attr('transform', 'translate(0,' + innerHeight + ')') <br>
            &nbsp;var xAxisLabel = xAxisG.append("text") <br>
            &nbsp;  .style("text-anchor", "middle")   br
            &nbsp;  .attr("transform", "translate(" + (innerWidth / 2) + "," + xAxisLabelOffset + ")") <br>
            &nbsp;  .attr("class", "label") <br>
            &nbsp;  .text(xAxisLabelText); <br>
            &nbsp;var yAxisG = g.append('g') <br>
            &nbsp;  .attr('class', 'y axis') <br>
            &nbsp;var yAxisLabel = yAxisG.append("text") <br>
            &nbsp;  .style("text-anchor", "middle") <br>
            &nbsp;  .attr("transform", "translate(-" + yAxisLabelOffset + "," + (innerHeight / 2) + ") rotate(-90)") <br>
            &nbsp;  .attr("class", "label") <br>
            &nbsp;  .text(yAxisLabelText); <br>
            <br>
            &nbsp;// set x, y scale range <br>
            &nbsp;var xScale = d3.scale.ordinal().rangeBands([0, innerWidth], barPadding); <br>
            &nbsp;var yScale = d3.scale.linear().range([innerHeight, 0]); <br>
            &nbsp;var colorScale = d3.scale.category10(); <br>
            <br>
            &nbsp;// Use a modified SI formatter that uses "B" for Billion. <br>
            &nbsp;var siFormat = d3.format("s"); <br>
            &nbsp;var customTickFormat = function (d){ <br>
            &nbsp;  return siFormat(d).replace("G", "B"); <br>
            &nbsp;}; <br>
            <br>
            &nbsp;// Instantiate axes <br>
            &nbsp;var xAxis = d3.svg.axis().scale(xScale).orient("bottom") <br>
            &nbsp;  .outerTickSize(0); <br>
            &nbsp;var yAxis = d3.svg.axis().scale(yScale).orient("left") <br>
            &nbsp;  .ticks(5) <br>
            &nbsp;  .tickFormat(customTickFormat) <br>
            &nbsp;  .outerTickSize(0); <br>
            <br>
            &nbsp;function render(data){ <br>
            &nbsp;  xScale.domain(data.map( function (d){ return d[xColumn]; })); <br>
            &nbsp;  yScale.domain([0, d3.max(data, function (d){ return d[yColumn]; })]); <br>
            &nbsp;  colorScale.domain(data.map( function (d) {return d[colorColumn]; })); <br>
            <br>
            &nbsp;  // render axes <br>
            &nbsp;  xAxisG <br>
            &nbsp;    .call(xAxis); <br>
            &nbsp;    .selectAll("text") <br>
            &nbsp;    .attr("dx", "-0.8em") <br>
            &nbsp;    .attr("dy", "1em") <br>
            &nbsp;    .attr("transform", "rotate(-20)"); <br>
            <br>
            &nbsp;  yAxisG.call(yAxis);   <br>
            <br>
            &nbsp;  var bars = g.selectAll("rect").data(data); <br>
            <br>
            &nbsp;  // enter phase <br>
            &nbsp;  bars.enter().append("rect") <br>
            &nbsp;    .attr("width", xScale.rangeBand()); <br>
            <br>
            &nbsp;  // update phase <br>
            &nbsp;  bars <br>
            &nbsp;    .attr("x", function (d){ return xScale(d[xColumn]); }) <br>
            &nbsp;    .attr("y", function (d){ return yScale(d[yColumn]); }) <br>
            &nbsp;    .attr("height", function (d){ return innerHeight - yScale(d[yColumn]); }) <br>
            &nbsp;    .attr("fill", function (d) { return colorScale(d[colorColumn]); }); <br>
            <br>
            &nbsp;  // exit phase <br>
            &nbsp;  bars.exit().remove(); <br>
            &nbsp;} <br>
            <br>
            &nbsp;function type(d){ <br>
            &nbsp;  d.population = +d.population; <br>
            &nbsp;  return d; <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv("religionWorldTotals.csv", type, render); <br>
            <br>
            &lt;/script&gt;
					</code>
				</div>
      </div>
      <br>
      <div id="stack-layout">
				<h4>Stacked layout</h4>
				<div class="row panel">
          <div id="example-103"></div>
          <ul>
            <li>Computes 2d graph data to stack</li>
            <li>x - the x-position of the value</li>
            <li>y - the y-thickness of the value</li>
            <li>y0 - the minimum y-position of the value (baseline)</li>
          </ul>
          <br>
					<p>index.html</p>
					<code>
            &lt;script&gt; <br>
            <br>
            &nbsp;var yColumn = "population"; <br>
            <br>
            &nbsp;function render(data){ <br>
            &nbsp;&nbsp;// create new instance of layout <br>
            &nbsp;&nbsp;var stack = d3.layout.stack() <br>
            &nbsp;&nbsp;&nbsp;// get y values <br>
            &nbsp;&nbsp;&nbsp;.y(function (d) { <br>
            &nbsp;&nbsp;&nbsp;&nbsp;return d[yColumn]; <br>
            &nbsp;&nbsp;&nbsp;}) <br>
            &nbsp;&nbsp;&nbsp;.values(function (d){ <br>
            &nbsp;&nbsp;&nbsp;return [d]; <br>
            &nbsp;&nbsp;&nbsp;}); <br>
            <br>
            &nbsp;&nbsp;var stacked = stack(data); <br>
            <br>
            &nbsp;&nbsp;d3.select("body").append("pre") <br>
            &nbsp;&nbsp;&nbsp;.text(JSON.stringify(stacked, null, 2)); <br>
            &nbsp;} <br>
            <br>
            &nbsp;function type(d){ <br>
            &nbsp;  d.population = +d.population; <br>
            &nbsp;  return d; <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv("religionWorldTotals.csv", type, render);<br>
            <br>
            &lt;/script&gt;
					</code>
				</div>
      </div>
      <br>
      <div id="splitting-rect">
				<h4>Splitting a rectangle</h4>
				<div class="row panel">
          <div id="example-104"></div>
          <br>
					<p>index.html</p>
					<code>
            &lt;style&gt; <br>
            &nbsp;.axis text { <br>
            &nbsp;&nbsp;font-family: 'Open Sans', sans-serif; <br>
            &nbsp;&nbsp;font-size: 16pt; <br>
            &nbsp;} <br>
            <br>
            &nbsp;.axis .label { <br>
            &nbsp;&nbsp;font-size: 20pt; <br>
            &nbsp;} <br>
            <br>
            &nbsp;.axis path, .axis line { <br>
            &nbsp;&nbsp;fill: none; <br>
            &nbsp;&nbsp;stroke: #000; <br>
            &nbsp;&nbsp;shape-rendering: crispEdges; <br>
            &nbsp;} <br>
            &lt;/style&gt; <br>
            <br>
            &lt;script&gt; <br>
            <br>
            &nbsp;// config vars <br>
            &nbsp;var outerWidth = 500; <br>
            &nbsp;var outerHeight = 250; <br>
            &nbsp;var margin = { left: 90, top: 30, right: 30, bottom: 40 }; <br>
            &nbsp;var barPadding = 0.2; <br>
            <br>
            &nbsp;// set x,y data <br>
            &nbsp;var xColumn = "region"; <br>
            &nbsp;var yColumn = "population"; <br>
            &nbsp;var colorColumn = "religion"; <br>
            <br>
            &nbsp;// set inner margin <br>
            &nbsp;var innerWidth  = outerWidth  - margin.left - margin.right; <br>
            &nbsp;var innerHeight = outerHeight - margin.top  - margin.bottom; <br>
            <br>
            &nbsp;// create svg <br>
            &nbsp;var svg = d3.select("body").append("svg") <br>
            &nbsp;  .attr("width",  outerWidth) <br>
            &nbsp;  .attr("height", outerHeight); <br>
            &nbsp;var g = svg.append("g") <br>
            &nbsp;  .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); <br>
            &nbsp;var xAxisG = g.append("g") <br>
            &nbsp;  .attr("class", "x axis") <br>
            &nbsp;  .attr("transform", "translate(0," + innerHeight + ")"); <br>
            &nbsp;var yAxisG = g.append("g") <br>
            &nbsp;  .attr("class", "y axis"); <br>
            <br>
            &nbsp;// set x, y scale range <br>
            &nbsp;var xScale = d3.scale.ordinal().rangeBands([0, innerWidth], barPadding); <br>
            &nbsp;var yScale = d3.scale.linear().range([innerHeight, 0]); <br>
            &nbsp;var colorScale = d3.scale.category10(); <br>
            <br>
            &nbsp;// Use a modified SI formatter that uses "B" for Billion. <br>
            &nbsp;var siFormat = d3.format("s"); <br>
            &nbsp;var customTickFormat = function (d){ <br>
            &nbsp;  return siFormat(d).replace("G", "B"); <br>
            &nbsp;}; <br>
            <br>
            &nbsp;// Instantiate axes <br>
            &nbsp;var xAxis = d3.svg.axis().scale(xScale).orient("bottom") <br>
            &nbsp;  .outerTickSize(0); <br>
            &nbsp;var yAxis = d3.svg.axis().scale(yScale).orient("left") <br>
            &nbsp;  .ticks(5) <br>
            &nbsp;  .tickFormat(customTickFormat) <br>
            &nbsp;  .outerTickSize(0); <br>
            <br>
            &nbsp;function render(data){ <br>
            &nbsp;&nbsp;colorScale.domain(data.map(function (d){ return d[colorColumn]; })); <br>
            <br>
            &nbsp;&nbsp;// instantiate stack layout data <br>
            &nbsp;&nbsp;var stack = d3.layout.stack() <br>
            &nbsp;&nbsp;  .y(function (d){ return d[yColumn]; }) <br>
            &nbsp;&nbsp;  .values(function (d){ return [d]; }); <br>
            <br>
            &nbsp;&nbsp;var stacked = stack(data); <br>
            &nbsp;&nbsp;xScale.domain(stacked.map(function (d){ return d[xColumn]; })); <br>
            &nbsp;&nbsp;yScale.domain([0, d3.max(stacked, function (d){ return d.y0 + d.y; })]); <br>
            <br>
            &nbsp;&nbsp;// render axes <br>
            &nbsp;&nbsp;xAxisG.call(xAxis); <br>
            &nbsp;&nbsp;yAxisG.call(yAxis); <br>
            <br>
            &nbsp;&nbsp;var bars = g.selectAll("rect").data(stacked); <br>
            &nbsp;&nbsp;// enter phase <br>
            &nbsp;&nbsp;bars.enter().append("rect") <br>
            <br>
            &nbsp;&nbsp;// update phase <br>
            &nbsp;&nbsp;bars <br>
            &nbsp;&nbsp;  .attr("x", function (d){ return xScale(d[xColumn]); }) <br>
            &nbsp;&nbsp;  .attr("y", function (d){ return yScale(d.y0 + d.y); }) <br>
            &nbsp;&nbsp;  .attr("width", xScale.rangeBand()); <br>
            &nbsp;&nbsp;  .attr("height", function (d){ return innerHeight - yScale(d.y); }) <br>
            &nbsp;&nbsp;  .attr("fill", function (d){ return colorScale(d[colorColumn]); }); <br>
            <br>
            &nbsp;&nbsp;// exit phase <br>
            &nbsp;&nbsp;bars.exit().remove(); <br>
            &nbsp;} <br>
            <br>
            &nbsp;function type(d){ <br>
            &nbsp;  d.region = "World"; <br>
            &nbsp;  d.population = +d.population; <br>
            &nbsp;  return d; <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv("religionWorldTotals.csv", type, render); <br>
            <br>
            &lt;/script&gt;
					</code>
				</div>
      </div>
      <br>
      <div id="dimensions-split">
				<h4>Adding another dimension to split rectangle</h4>
				<div class="row panel">
          <div id="example-105"></div>
          <br>
					<p>index.html</p>
          <code>
            &lt;script&gt; <br>
            <br>
            &nbsp;function render (data) { <br>
            &nbsp;  d3.select("body").append("pre") <br>
            &nbsp;    .text(JSON.stringify(data, null, 2)); <br>
            &nbsp;} <br>
            <br>
            &nbsp;function type (d) { <br>
            &nbsp;  d.population = +d.population; <br>
            &nbsp;  return d; <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv("religionByCountryTop5.csv", type, render); <br>
            <br>
            &lt;/script&gt;
          </code>
				</div>
      </div>
      <br>
      <div id="d3-nest">
				<h4>Introducing D3.nest</h4>
				<div class="row panel">
          <div id="example-106"></div>
          <br>
					<p>index.html</p>
          <code>
            &lt;script&gt; <br>
            <br>
            &nbsp;function render(data){ <br>
            &nbsp;var nested = d3.nest() <br>
            &nbsp;  .key(function (d){ return d.country; }) <br>
            &nbsp;  .entries(data); <br>
            <br>
            &nbsp;d3.select("body").append("pre") <br>
            &nbsp;  .text(JSON.stringify(nested, null, 2)); <br>
            &nbsp;} <br>
            <br>
            &nbsp;function type(d){ <br>
            &nbsp;  d.population = +d.population; <br>
            &nbsp;  return d; <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv("religionByCountryTop5.csv", type, render); <br>
            <br>
            &lt;/script&gt;
          </code>
				</div>
      </div>
      <br>
      <div id="nest-stack">
				<h4>Nest and stack</h4>
				<div class="row panel">
          <div id="example-107"></div>
          <br>
					<p>index.html</p>
          <code>
            &lt;script&gt; <br>
            <br>
            &nbsp;function render (data) { <br>
            &nbsp;&nbsp;// Assign key values and get entries from CSV <br>
            &nbsp;&nbsp;var nested = d3.nest() <br>
            &nbsp;&nbsp;  .key(function (d) { return d[layerColumn]; }) <br>
            &nbsp;&nbsp;  .entries(data) <br>
            <br>
            &nbsp;&nbsp;// assign y0 & values from elements of the CSV array<br>
            &nbsp;&nbsp;var stack = d3.layout.stack() <br>
            &nbsp;&nbsp;  .y(function (d) { return d[yColumn]; }) <br>
            &nbsp;&nbsp;  .values(function (d) { return d.values; }) <br>
            <br>
            &nbsp;&nbsp;var layers = stack(nested) <br>
            <br>
            &nbsp;&nbsp;d3.select('body').append('pre') <br>
            &nbsp;&nbsp;  .text(JSON.stringify(layers, null, 2)) <br>
            &nbsp;} <br>
            <br>
            &nbsp;function type (d) { <br>
            &nbsp;&nbsp;d.population = +d.population <br>
            &nbsp;&nbsp;return d <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv('religionByCountryTop5.csv', type, render) <br>
            <br>
            &lt;/script&gt;
          </code>
				</div>
      </div>
      <br>
      <div id="stacked-bars">
				<h4>Stacked bars</h4>
				<div class="row panel">
          <div id="example-108"></div>
          <br>
					<p>index.html</p>
          <code>
            &lt;script&gt; <br>
            <br>
            &nbsp;var outerWidth = 500; <br>
            &nbsp;var outerHeight = 250; <br>
            &nbsp;var margin = { left: 90, top: 30, right: 30, bottom: 40 }; <br>
            &nbsp;var barPadding = 0.2; <br>
            <br>
            &nbsp;var xColumn = "country"; <br>
            &nbsp;var yColumn = "population"; <br>
            &nbsp;var colorColumn = "religion"; <br>
            &nbsp;var layerColumn = colorColumn; <br>
            <br>
            &nbsp;var innerWidth  = outerWidth  - margin.left - margin.right; <br>
            &nbsp;var innerHeight = outerHeight - margin.top  - margin.bottom; <br>
            <br>
            &nbsp;var svg = d3.select("body").append("svg") <br>
            &nbsp;  .attr("width",  outerWidth) <br>
            &nbsp;  .attr("height", outerHeight); <br>
            &nbsp;var g = svg.append("g") <br>
            &nbsp;  .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); <br>
            &nbsp;var xAxisG = g.append("g") <br>
            &nbsp;  .attr("class", "x axis") <br>
            &nbsp;  .attr("transform", "translate(0," + innerHeight + ")"); <br>
            &nbsp;var yAxisG = g.append("g") <br>
            &nbsp;  .attr("class", "y axis"); <br>
            <br>
            &nbsp;var xScale = d3.scale.ordinal().rangeBands([0, innerWidth], barPadding); <br>
            &nbsp;var yScale = d3.scale.linear().range([innerHeight, 0]); <br>
            &nbsp;var colorScale = d3.scale.category10(); <br>
            <br>
            &nbsp;// Use a modified SI formatter that uses "B" for Billion. <br>
            &nbsp;var siFormat = d3.format("s"); <br>
            &nbsp;var customTickFormat = function (d){ <br>
            &nbsp;  return siFormat(d).replace("G", "B"); <br>
            &nbsp;};
            <br>
            &nbsp;var xAxis = d3.svg.axis().scale(xScale).orient("bottom") <br>
            &nbsp;  .outerTickSize(0); <br>
            &nbsp;var yAxis = d3.svg.axis().scale(yScale).orient("left") <br>
            &nbsp;  .ticks(5) <br>
            &nbsp;  .tickFormat(customTickFormat) <br>
            &nbsp;  .outerTickSize(0); <br>
            <br>
            &nbsp;function render(data){ <br>
            &nbsp;&nbsp;var nested = d3.nest() <br>
            &nbsp;&nbsp;&nbsp;.key(function (d){ return d[layerColumn]; }) <br>
            &nbsp;&nbsp;&nbsp;.entries(data) <br>
            &nbsp;&nbsp;var stack = d3.layout.stack() <br>
            &nbsp;&nbsp;&nbsp;.y(function (d){ return d[yColumn]; }) <br>
            &nbsp;&nbsp;&nbsp;.values(function (d){ return d.values; }); <br>
            &nbsp;&nbsp;var layers = stack(nested); <br>
            <br>
            &nbsp;&nbsp;xScale.domain(layers[0].values.map(function (d){ <br>
            &nbsp;&nbsp;  return d[xColumn]; <br>
            &nbsp;&nbsp;})); <br>
            &nbsp;&nbsp;yScale.domain([ <br>
            &nbsp;&nbsp;  0, <br>
            &nbsp;&nbsp;  d3.max(layers, function (layer){ <br>
            &nbsp;&nbsp;&nbsp;    return d3.max(layer.values, function (d){ <br>
            &nbsp;&nbsp;&nbsp;&nbsp;      return d.y0 + d.y; <br>
            &nbsp;&nbsp;&nbsp;    }); <br>
            &nbsp;&nbsp;  }) <br>
            &nbsp;&nbsp;]); <br>
            &nbsp;&nbsp;colorScale.domain(layers.map(function (layer){ <br>
            &nbsp;&nbsp;  return layer.key; <br>
            &nbsp;&nbsp;})); <br>
              <br>
            &nbsp;  xAxisG.call(xAxis); <br>
            &nbsp;  yAxisG.call(yAxis); <br>
              <br>
            &nbsp;  var layerGroups = g.selectAll(".layer").data(layers); <br>
            &nbsp;  layerGroups.enter().append("g").attr("class", "layer"); <br>
            &nbsp;  layerGroups.exit().remove(); <br>
            &nbsp;  layerGroups.style("fill", function (d){ <br>
            &nbsp;&nbsp;    return colorScale(d.key); <br>
            &nbsp;  }); <br>
              <br>
            &nbsp;  var bars = layerGroups.selectAll("rect").data(function (d){ <br>
            &nbsp;&nbsp;    return d.values; <br>
            &nbsp;  }); <br>
              <br>
            &nbsp;  bars.enter().append("rect") <br>
              <br>
            &nbsp;  bars.exit().remove(); <br>
              <br>
            &nbsp;  bars <br>
            &nbsp;    .attr("x", function (d){ return xScale(d[xColumn]); }) <br>
            &nbsp;    .attr("y", function (d){ return yScale(d.y0 + d.y); }) <br>
            &nbsp;    .attr("width", xScale.rangeBand()) <br>
            &nbsp;    .attr("height", function (d){ return innerHeight - yScale(d.y); }) <br>
            &nbsp;} <br>
            <br>
            &nbsp;function type(d){ <br>
            &nbsp;  d.population = +d.population; <br>
            &nbsp;  return d; <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv("religionByCountryTop5.csv", type, render); <br>
            <br>
            &lt;/script&gt;
          </code>
				</div>
      </div>
      <br>
      <div id="color-legend">
				<h4>Adding color lengend</h4>
				<div class="row panel">
          <div id="example-109"></div>
          <br>
					<p>index.html</p>
          <code>
            &lt;style&gt; <br>
            &nbsp;.color-legend text { <br>
            &nbsp;&nbsp;font-family: 'Open Sans', sans-serif; <br>
            &nbsp;&nbsp;font-size: 10pt; <br>
            &nbsp;}  <br>
            &lt;/style&gt; <br>
            &lt;script&gt; <br>
            <br>
            &nbsp;var outerWidth = 500; <br>
            &nbsp;var outerHeight = 250; <br>
            &nbsp;var margin = { left: 90, top: 30, right: 30, bottom: 40 }; <br>
            &nbsp;var barPadding = 0.2; <br>
            <br>
            &nbsp;var xColumn = "country"; <br>
            &nbsp;var yColumn = "population"; <br>
            &nbsp;var colorColumn = "religion"; <br>
            &nbsp;var layerColumn = colorColumn; <br>
            <br>
            &nbsp;var innerWidth  = outerWidth  - margin.left - margin.right; <br>
            &nbsp;var innerHeight = outerHeight - margin.top  - margin.bottom; <br>
            <br>
            &nbsp;var svg = d3.select("body").append("svg") <br>
            &nbsp;  .attr("width",  outerWidth) <br>
            &nbsp;  .attr("height", outerHeight); <br>
            &nbsp;var g = svg.append("g") <br>
            &nbsp;  .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); <br>
            &nbsp;var xAxisG = g.append("g") <br>
            &nbsp;  .attr("class", "x axis") <br>
            &nbsp;  .attr("transform", "translate(0," + innerHeight + ")"); <br>
            &nbsp;var yAxisG = g.append("g") <br>
            &nbsp;  .attr("class", "y axis"); <br>
            &nbsp;var colorLegendG = g.append("g") <br>
            &nbsp;  .attr("class", "color-legend") <br>
            &nbsp;  .attr("transform", "translate(235, 0)"); <br>
            <br>
            &nbsp;var xScale = d3.scale.ordinal().rangeBands([0, innerWidth], barPadding); <br>
            &nbsp;var yScale = d3.scale.linear().range([innerHeight, 0]); <br>
            &nbsp;var colorScale = d3.scale.category10(); <br>
            <br>
            &nbsp;// Use a modified SI formatter that uses "B" for Billion. <br>
            &nbsp;var siFormat = d3.format("s"); <br>
            &nbsp;var customTickFormat = function (d){ <br>
            &nbsp;  return siFormat(d).replace("G", "B"); <br>
            &nbsp;}; <br>
            &nbsp;var xAxis = d3.svg.axis().scale(xScale).orient("bottom") <br>
            &nbsp;  .outerTickSize(0); <br>
            &nbsp;var yAxis = d3.svg.axis().scale(yScale).orient("left") <br>
            &nbsp;  .ticks(5) <br>
            &nbsp;  .tickFormat(customTickFormat) <br>
            &nbsp;  .outerTickSize(0); <br>
            &nbsp;var colorLegend = d3.legend.color() <br>
            &nbsp;  .scale(colorScale) <br>
            &nbsp;  .shapePadding(3) <br>
            &nbsp;  .shapeWidth(15) <br>
            &nbsp;  .shapeHeight(15) <br>
            &nbsp;  .labelOffset(4); <br>
            <br>
            &nbsp;function render(data){ <br>
            &nbsp;  var nested = d3.nest() <br>
            &nbsp;&nbsp;    .key(function (d){ return d[layerColumn]; }) <br>
            &nbsp;&nbsp;    .entries(data) <br>
            &nbsp;  var stack = d3.layout.stack() <br>
            &nbsp;&nbsp;    .y(function (d){ return d[yColumn]; }) <br>
            &nbsp;&nbsp;    .values(function (d){ return d.values; }); <br>
            &nbsp;  var layers = stack(nested); <br>
            <br>
            &nbsp;  xScale.domain(layers[0].values.map(function (d){ <br>
            &nbsp;&nbsp;    return d[xColumn]; <br>
            &nbsp;  })); <br>
            &nbsp;  yScale.domain([ <br>
            &nbsp;&nbsp;    0, <br>
            &nbsp;&nbsp;    d3.max(layers, function (layer){ <br>
            &nbsp;&nbsp;&nbsp;      return d3.max(layer.values, function (d){ <br>
            &nbsp;&nbsp;&nbsp;&nbsp;        return d.y0 + d.y; <br>
            &nbsp;&nbsp;&nbsp;      }); <br>
            &nbsp;&nbsp;    }) <br>
            &nbsp;  ]); <br>
            &nbsp;  colorScale.domain(layers.map(function (layer){ <br>
            &nbsp;&nbsp;    return layer.key; <br>
            &nbsp;  })); <br>
              <br>
            &nbsp;  xAxisG.call(xAxis); <br>
            &nbsp;  yAxisG.call(yAxis); <br>
              <br>
            &nbsp;  var layers = g.selectAll(".layer").data(layers); <br>
            <br>
            &nbsp;  layers.enter().append("g").attr("class", "layer"); <br>
            <br>
            &nbsp;  layers.exit().remove(); <br>
            <br>
            &nbsp;  layers.style("fill", function (d){ <br>
            &nbsp;&nbsp;    return colorScale(d.key); <br>
            &nbsp;  }); <br>
              <br>
            &nbsp;  var bars = layers.selectAll("rect").data(function (d){ <br>
            &nbsp;&nbsp;    return d.values; <br>
            &nbsp;  }); <br>
              <br>
            &nbsp;  bars.enter().append("rect") <br>
              <br>
            &nbsp;  bars.exit().remove(); <br>
              <br>
            &nbsp;  bars <br>
            &nbsp;    .attr("x", function (d){ return xScale(d[xColumn]); }) <br>
            &nbsp;    .attr("y", function (d){ return yScale(d.y0 + d.y); }) <br>
            &nbsp;    .attr("width", xScale.rangeBand()) <br>
            &nbsp;    .attr("height", function (d){ return innerHeight - yScale(d.y); }) <br>
              <br>
            &nbsp;  colorLegendG.call(colorLegend); <br>
            }
            <br>
            &nbsp;function type(d){ <br>
            &nbsp;  d.population = +d.population; <br>
            &nbsp;  return d; <br>
            &nbsp;} <br>
            <br>
            &nbsp;d3.csv("religionByCountryTop5.csv", type, render); <br>
            <br>
            &lt;/script&gt;
          </code>
				</div>
      </div>
      <div class="row">
        <a href="./">Back</a>
      </div>
		</div>
	</div>
  <footer>
    <p class="text-center">A D3 introduction by <a href="https://github.com/curran/screencasts/tree/gh-pages/introToD3">Curran Kelleher</a>.<span> Notes written by <a href="https://github.com/flight846">Yazid Ismail</a></span></p>
  </footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/d3-legend/1.1.0/d3-legend.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="js/example.js"></script>
</body>
</html>
